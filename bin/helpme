#!/usr/bin/env node

const util = require('util'),
    Burgeon = new require('../lib/burgeon'),
    rl = require('readline-sync');

const burgeon = new Burgeon();
const items = ['å®‰è£…ssh-key', 'å®‰è£…crud', 'å®‰è£…md2js', 'å®‰è£…kml'];
console.log('ï¼**************** æ¬¢è¿ä½¿ç”¨itomixè‡ªåŠ¨å®‰è£…å·¥å…·ğŸ”§****************ï¼');

while (true) {
    try{
        let select = rl.keyInSelect(items, 'è¯·é€‰æ‹©æ‚¨éœ€è¦çš„æœåŠ¡ï¼Ÿ');

        switch (select) {
            case 0:
                while (true) {
                    let items = ['ç”Ÿæˆssh', 'æŸ¥çœ‹sshå…¬é’¥', 'æŸ¥çœ‹å¤‡ä»½sshå…¬é’¥', 'å¤‡ä»½ssh', 'æ¢å¤ssh'];
                    let select = rl.keyInSelect(items, '1. ->è¯·é€‰æ‹©æ‚¨éœ€è¦çš„æœåŠ¡ï¼Ÿ');
                    switch (select) {
                        case 0:
                            let email = rl.questionEMail('è¯·è¾“å…¥æ‚¨çš„é‚®ç®±ğŸ“®åœ°å€ï¼š')
                            burgeon.createSsh(email);
                            break;
                        case 1:
                            burgeon.catPublicSsh();
                            break;
                        case 2:
                            burgeon.catBkPublicSsh();
                            break;
                        case 3:
                            burgeon.bkSsh();
                            break;
                        case 4:
                            burgeon.recoverSsh();
                            break;
                        case -1:
                        default:
                            break;
                    }
                    if (select === -1) {
                        break;
                    }
                }//while
                break;

            case 1:
                while (true) {
                    let items = ['crudä»‹ç»', 'å®‰è£…crud', 'æ£€æŸ¥æ˜¯å¦å®‰è£…'];
                    let select = rl.keyInSelect(items, '2. ->è¯·é€‰æ‹©æ‚¨éœ€è¦çš„æœåŠ¡ï¼Ÿ');
                    switch (select) {
                        case 0:
                            burgeon.crudDescription();
                            break;
                        case 1:
                            burgeon.install('crud-tools', 'git@gitlab.kmlab.com:tools/crud-tools.git');;
                            break;
                        case 2:
                            burgeon.testInstall('crud');
                            break;
                        case -1:
                        default:
                            break;
                    }
                    if (select === -1) {
                        break;
                    }
                }//while
                break;

            case 2:
                while (true) {
                    let items = ['md2jsä»‹ç»', 'å®‰è£…md2js','æ£€æŸ¥æ˜¯å¦å®‰è£…'];
                    let select = rl.keyInSelect(items, '3. ->è¯·é€‰æ‹©æ‚¨éœ€è¦çš„æœåŠ¡ï¼Ÿ');
                    switch (select) {
                        case 0:
                            burgeon.md2jsDescription();
                            break;
                        case 1:
                            burgeon.install('md2js', 'git@github.com:yujintang/md2js.git');
                            break;
                        case 2:
                            burgeon.testInstall('md2js');
                            break;
                        case -1:
                        default:
                            break;
                    }
                    if (select === -1) {
                        break;
                    }
                }//while
                break;

            case 3:
                while (true) {
                    let items = ['kmlä»‹ç»', 'å®‰è£…kml','æ£€æŸ¥æ˜¯å¦å®‰è£…'];
                    let select = rl.keyInSelect(items, '4. ->è¯·é€‰æ‹©æ‚¨éœ€è¦çš„æœåŠ¡ï¼Ÿ');
                    switch (select) {
                        case 0:
                            burgeon.kmlDescription();
                            break;
                        case 1:
                            burgeon.install('kml', 'git@gitlab.kmlab.com:npms/kml.git')
                            break;
                        case 2:
                            burgeon.testInstall('kml');
                            break;
                        case -1:
                        default:
                            break;
                    }
                    if (select === -1) {
                        break;
                    }
                }//while
                break;

            case -1:
            default:
                console.log('å†è§ï¼\n');
                break;
        }
        if (select === -1) {2
            break;
        }
    }catch (e){
        console.log(`ç¨‹åºé”™è¯¯âŒï¼` + e);
        break;
    }
}//while